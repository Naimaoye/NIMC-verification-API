{"version":3,"sources":["../../src/util/checkAuth.js"],"names":["Authentication","req","res","next","authHeader","headers","authorization","token","split","decoded","jwt","verify","SECRET_KEY","user","status","json","message"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACA;;IAIMA,c;;;;;;;;uGAEF,iBAAyBC,GAAzB,EAA8BC,GAA9B,EAAmCC,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AACIC,gBAAAA,UADJ,GACiBH,GAAG,CAACI,OAAJ,CAAYC,aAD7B;;AAAA,qBAEEF,UAFF;AAAA;AAAA;AAAA;;AAGMG,gBAAAA,KAHN,GAGcH,UAAU,CAACI,KAAX,CAAiB,SAAjB,EAA4B,CAA5B,CAHd;;AAAA,qBAIID,KAJJ;AAAA;AAAA;AAAA;;AAAA;AAMUE,gBAAAA,OANV,GAMoBC,yBAAIC,MAAJ,CAAWJ,KAAX,EAAkBK,kBAAlB,CANpB;AAOIX,gBAAAA,GAAG,CAACY,IAAJ,GAAWJ,OAAX;AAPJ,iDAQWN,IAAI,EARf;;AAAA;AAAA;AAAA;AAAA,iDAUWD,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,kBAAAA,MAAM,EAAE,GADgB;AAExBE,kBAAAA,OAAO,EAAE;AAFe,iBAArB,CAVX;;AAAA;AAAA,iDAgBOd,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,kBAAAA,MAAM,EAAE,GADgB;AAExBE,kBAAAA,OAAO,EAAE;AAFe,iBAArB,CAhBP;;AAAA;AAAA,iDAqBKd,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,GADkB;AAE1BE,kBAAAA,OAAO,EAAE;AAFiB,iBAArB,CArBL;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;;eA6BWhB,c","sourcesContent":["import jwt from 'jsonwebtoken';\nimport { SECRET_KEY } from '../config/config'\n\n\n\nclass Authentication {\n\n    static async verifyToken(req, res, next){\n  const authHeader = req.headers.authorization;\n  if (authHeader) {\n    const token = authHeader.split('Bearer ')[1];\n    if (token) {\n      try {\n        const decoded = jwt.verify(token, SECRET_KEY);\n        req.user = decoded;\n        return next();\n      } catch (err) {\n        return res.status(403).json({\n            status: 403, \n            message: 'Invalid/Expired token, make sure you are loggedIn'\n    });\n      }\n    }\n    return res.status(403).json({\n        status: 403, \n        message: 'Authentication token must be Bearer [token]'\n    });\n  }\n  return res.status(403).json({\n    status: 403, \n    message: 'Authorization header must be provided'\n    });\n};\n\n}\n\nexport default Authentication;"],"file":"checkAuth.js"}